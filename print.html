<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Document Graph</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="background/introduction.html">Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">Background</li><li class="chapter-item expanded "><a href="background/triples.html"><strong aria-hidden="true">1.</strong> Semantic Triples</a></li><li class="chapter-item expanded "><a href="background/migrations.html"><strong aria-hidden="true">2.</strong> Data Migrations</a></li><li class="chapter-item expanded "><a href="background/use-cases.html"><strong aria-hidden="true">3.</strong> Use Cases</a></li><li class="chapter-item expanded "><a href="background/links.html"><strong aria-hidden="true">4.</strong> Links</a></li><li class="chapter-item expanded affix "><li class="part-title">Specification</li><li class="chapter-item expanded "><a href="specification/features.html"><strong aria-hidden="true">5.</strong> Features</a></li><li class="chapter-item expanded "><a href="specification/graph.html"><strong aria-hidden="true">6.</strong> Graph</a></li><li class="chapter-item expanded "><a href="specification/documents.html"><strong aria-hidden="true">7.</strong> Documents</a></li><li class="chapter-item expanded "><a href="specification/edges.html"><strong aria-hidden="true">8.</strong> Edges</a></li><li class="chapter-item expanded affix "><li class="part-title">Implementations</li><li class="chapter-item expanded "><a href="specification/eosio.html"><strong aria-hidden="true">9.</strong> EOSIO</a></li><li class="chapter-item expanded "><a href="specification/substrate.html"><strong aria-hidden="true">10.</strong> Substrate</a></li><li class="chapter-item expanded affix "><li class="part-title">Explorer</li><li class="chapter-item expanded "><a href="explorer/getting-started.html"><strong aria-hidden="true">11.</strong> Getting Started</a></li><li class="chapter-item expanded "><a href="explorer/tutorials.html"><strong aria-hidden="true">12.</strong> Tutorials</a></li><li class="chapter-item expanded affix "><li class="part-title">dgctl CLI</li><li class="chapter-item expanded "><a href="dgctl/installation.html"><strong aria-hidden="true">13.</strong> Installation</a></li><li class="chapter-item expanded "><a href="dgctl/commands.html"><strong aria-hidden="true">14.</strong> Commands</a></li><li class="chapter-item expanded "><a href="contributing.html"><strong aria-hidden="true">15.</strong> Contributing</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Document Graph</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>Document Graph is a flexible persistence and modeling framework for blockchain applications.</p>
<h1 id="overview"><a class="header" href="#overview">Overview</a></h1>
<ol>
<li>
<p>Document is a node in the graph. Documents have a:</p>
<ul>
<li>ID (system assigned &amp; immutable)</li>
<li>Label</li>
<li>Owner (could be owned by a DAO)</li>
<li>Content
<ul>
<li>Text or Primitive type data (e.g. % interest or 2.50 USD)</li>
<li>Files, photos, videos, saved into IPFS with the CID saved in the document.</li>
<li>Any content can be optionally encrypted with a password that can be shared through a side channel.</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Edges connect nodes. Each edge has:</p>
<ul>
<li>From Node</li>
<li>To Node</li>
<li>Edge Name (type: <code>eosio::name</code>)</li>
<li>Owner</li>
</ul>
</li>
<li>
<p>Only the owner can edit a document or an edge (e.g. only <code>dao.hypha</code> can edit a document created by the DHO)</p>
</li>
<li>
<p>Anyone can extend an existing graph with documents that they are the <code>owner</code> of. This allows for multitenant control over different data in the same graph.</p>
</li>
</ol>
<p><img src="background/dge2.png" alt="Extend example" /></p>
<ol start="5">
<li>Document Graph includes a web-based Explorer and Editor that allows non-technical users to directly <code>create</code>, <code>edit</code>, <code>erase</code>, and <code>extend</code>. Screenshot shows <code>edit</code> screen where user has encrypted the <code>reference</code> field and saved the <code>secret key</code> to IPFS.  <strong>(not recommended, this was just to illustrate the functionality)</strong></li>
</ol>
<p><img src="background/dge1.png" alt="Document Graph Explorer" /></p>
<ol start="6">
<li>
<p>Actions can be deployed anywhere on the layer 1 to interact with the graph. The code in those contracts will modify the graph contents, but will require the permission of the <code>owner</code> that created it. The default contract has all of the basic actions (e.g. trigger a proposal if the right DAO/DHO/owner for edits). But it is compatible with any contracts on the layer 1, so it allows for trustless deployment of business logic that scales to the bounds of the layer 1. </p>
</li>
<li>
<p>All data in the graph is accessible via GraphQL endpoints, which can be used to integrate any client or stitched to other graph data sources.</p>
</li>
<li>
<p>The documents can be certified by anyone, this allows to ensure the content of the document</p>
</li>
</ol>
<p><img src="background/certificate.png" alt="Certificate example" /></p>
<h2 id="example-graph"><a class="header" href="#example-graph">Example Graph</a></h2>
<ul>
<li>member is a member of two organizations</li>
<li>badges are owned by the Badge Librarian</li>
<li>members are assigned badges</li>
<li>member has been paid multiple times</li>
</ul>
<p><img src="background/graph-example.png" alt="Example Graph" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="semantic-triples"><a class="header" href="#semantic-triples">Semantic Triples</a></h1>
<p>Databases typically store data in a tabular format, where a table has set of columns and rows, like a spreadsheet.</p>
<p>However, IRL, we tend to think in statements of <code>Subject</code>, <code>Predicate</code> (<code>Verb</code>), and <code>Object</code>. This is particularly true in the English language where word order is subject, verb, object (SVO). This information construct is known as <code>triples</code>, or <a href="https://en.wikipedia.org/wiki/Semantic_triple">semantic triples</a>. The <a href="https://www.w3.org/RDF/">W3C Resource Description Framework</a> is a leading specification for organizing these statements into semantic triples. </p>
<p>As Lenhert describes <a href="https://www.synaptica.com/triples-triads-and-semantics/">here</a>: </p>
<blockquote>
<p>&quot;One of the fundamental benefits of these RDF-based controlled vocabulary structures are their dual nature as being both human intelligible as well as machine readable (and, therefore, portable). Like their basic constituent subject-verb-object basis, ontologies convey rich meaning in relatively simple and compact statements, making them extremely useful in modeling complex knowledge environments.&quot;</p>
</blockquote>
<p>The following diagrams express semantic triples in various terms.</p>
<h3 id="using-the-natural-english-sov-terms"><a class="header" href="#using-the-natural-english-sov-terms">Using the natural English <a href="https://en.wikipedia.org/wiki/Subject%E2%80%93verb%E2%80%93object">SOV</a> terms</a></h3>
<p><img src="background/../mdbook-plantuml-img/78989bc2f1de18b47d669cbeaefd3ef8c6362d1f.svg" alt="" /></p>
<h3 id="using-common-graph-theory-terms"><a class="header" href="#using-common-graph-theory-terms">Using common <a href="https://en.wikipedia.org/wiki/Vertex_(graph_theory)">graph theory</a> terms</a></h3>
<p><img src="background/../mdbook-plantuml-img/1eeb8b5c48f63e8ec6d078150ebf4dac6f1ee08c.svg" alt="" /></p>
<h3 id="using-the-document-graph-terms"><a class="header" href="#using-the-document-graph-terms">Using the Document Graph terms</a></h3>
<p><img src="background/../mdbook-plantuml-img/5b5014a7b9f13f529d6d4d61996a42fc2fe88b59.svg" alt="" /></p>
<p>Note that edges are both directional and labeled.</p>
<h3 id="simple-example-of-a-semantic-triple"><a class="header" href="#simple-example-of-a-semantic-triple">Simple Example of a Semantic Triple</a></h3>
<p><img src="background/../mdbook-plantuml-img/cc8c5139926999f515e3f3794eb0fe4a5f2cfd5c.svg" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="blockchain-change-management"><a class="header" href="#blockchain-change-management">Blockchain Change Management</a></h2>
<p>At their core, blockchains are used to manage data and state changes on that data. The structure of this data is nearly always based on a custom-built struct within a pallet or smart contract. Applications that are built on blockchains are typically built for a specific smart contract’s data structure, and the application is highly coupled to that application.  When a data structure changes, it typically requires a complex migration of existing data and source code within the smart contract as well as perhaps changes to other backend or service layers and the application itself. </p>
<p>For example, assume the overly simplified struct within a smart contract. Upon an approval, the amount would be sent to the account indicated.</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct Proposal {
    pub label: str,
    pub account: AccountId,
    pub amount: u32,
}
<span class="boring">}
</span></code></pre></pre>
<p>Then, let's say the DAO wants to add support for recurring payments. This would need to be supported within the data model by adding a time period to use as the recurring period and the total number of payments.</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub struct Proposal {
    pub title: str,
    pub account: AccountId,
    pub amount: u32,
    pub time_period_seconds: u32,
    pub payment_count: u32,
}
<span class="boring">}
</span></code></pre></pre>
<p>Depending on the blockchain, this change management event requires a series of gymnastics by developers to maintain a reasonable user experience. For example, on non-upgradable platforms, it may require clients to query from both structs, or if upgradable, may require erasing data from the original data store and recreating it (losing metadata in the process). Some may require maintaining both structures and adding a roll-up of sorts to maintain client backwards compatibility.</p>
<p>All of these complications create a significant change management burden on software developers.</p>
<h3 id="document-graph-solves-this"><a class="header" href="#document-graph-solves-this">Document Graph Solves This</a></h3>
<p>Document Graph alleviates the need for developers to change their persistence layer when making upgrades to their data model. </p>
<p>This is achieved by supporting flexible variant pairs within a consistently structured <code>document</code> type and support for an <code>edge</code> type used to link the graph's documents in meaningful ways. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="use-cases"><a class="header" href="#use-cases">Use Cases</a></h1>
<p>Document Graph is currently used for a number of use cases. Here are some real-world examples that we are using it for. Interestingly, all of the below use cases can be handled within the same graph where nodes can be linked to each other across contexts.</p>
<h3 id="daos"><a class="header" href="#daos">DAOs</a></h3>
<p>DAOs have have descriptive attributes. They also have members, proposals, assignments, quests, bounties, badges, and many other data types that are maintained to support a fully functional platform. </p>
<p>Here's an actual example of how Document Graph is used to manage a few components within a DAO's information space. </p>
<p><img src="background/graph-example.png" alt="Example Graph" /></p>
<h3 id="supply-chain"><a class="header" href="#supply-chain">Supply Chain</a></h3>
<p>We use Document Graph for a supply chain traceability application. An <code>Item</code> and its various <code>Checkpoints</code> are saved as <code>documents</code>. When a new QR code <code>scan</code> event occurs, it extends the graph for that item to contain a new <code>Checkpoint</code>.</p>
<p>Since a <code>Checkpoint</code> is a document, it can store any arbitrary data that describes that event, such as weight, longitude, latitude, cost, and even photos or other files such as packing lists. Files are stored in IPFS and anchored into the on-chain document. </p>
<p>Users have the option to save data directly onto the chain (for access within smart contracts) or to save the data to IPFS. Users also have the option to encrypt the data with a password of their choice.</p>
<p><img src="background/../mdbook-plantuml-img/4680acacedd82811b8dc57cbae2db7399d9d4e2d.svg" alt="" /></p>
<h3 id="accounting"><a class="header" href="#accounting">Accounting</a></h3>
<p>We also use the Document Graph to store data required to operate a double-entry accounting system. This system allows users to generate classical accounting reports such as Balance Sheet and Income Statement from blockchain transactions.</p>
<p>Accountants must be able to tag transactions with additional data, references, files, etc., and they must also be able to assign a general ledger account to appropriately calculate debits and credits.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="useful-links"><a class="header" href="#useful-links">Useful Links</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="features"><a class="header" href="#features">Features</a></h1>
<h2 id="end-user-accessibility"><a class="header" href="#end-user-accessibility">End-user Accessibility</a></h2>
<p>The Document Graph Explorer allows for any user with a blockchain account to create and edit content that they own within the graph, and they may create between any two nodes in the graph.</p>
<p>This level of accessibility to non-technical users is unprecedented. It allows them to collaboratively create and connect content with all of the benefits of blockchain. This level of capability was previously only accessible to highly technical engineers.</p>
<h2 id="file-and-ipfs-integration"><a class="header" href="#file-and-ipfs-integration">File and IPFS Integration</a></h2>
<p>Document Graph has integrated support for storing data or files within <a href="https://ipfs.io/">IPFS</a> and saving that files’ CID (hash) within the document. </p>
<h2 id="encryption-support"><a class="header" href="#encryption-support">Encryption Support</a></h2>
<p>Document Graph Explorer supports encryption of a specific content item’s value. In DGE, the user is prompted to enter a password that is used for symmetric AES encryption. This secret simply encrypts the value and the ciphertext is persisted in the document. </p>
<p>In a future release, we may integrate with the <a href="https://phala.network/en/">Khala/Phala</a> confidential blockchain. Also, we are evaluating integration with <a href="https://www.pad.tech/">PAD</a> as a trustless way to share the secret in a manner that alerts the owner when the secret is accessed. This is useful for interesting use cases such as one-time decrypt use cases and “in case of emergency” use cases.</p>
<h2 id="graphql-caching"><a class="header" href="#graphql-caching">GraphQL Caching</a></h2>
<p>Document Graph supports easy integration with <a href="https://dgraph.io">DGraph</a>, an open source distributed graph engine. The document graph cache listens for new blocks, and upon finalization, updates the DGraph graph to reflect any updates to the on-chain graph. DGraph has excellent tooling and ergonomics for querying, custom types or schemas, data visualizer, full-text search, and much more. </p>
<h2 id="composable-sdk-experience-cli"><a class="header" href="#composable-sdk-experience-cli">Composable SDK Experience (CLI)</a></h2>
<p>Document Graph is built to be highly composable and also support an ergonomic developer experience. In addition to the Document Graph Explorer web application, there is a CLI (written in Go) that supports all of the create, read, update, and delete operations directly against the blockchain. </p>
<h2 id="plugin-architecture-for-custom-renderers-and-editors"><a class="header" href="#plugin-architecture-for-custom-renderers-and-editors">Plugin Architecture for Custom Renderers and Editors</a></h2>
<p>Developers can include special fields within their document to enable custom viewers or editors. For example, if the field “preferred_renderer” or “preferred_editor” is populated with an endpoint, this endpoint will be used to render or edit the document.</p>
<h2 id="elastic-search"><a class="header" href="#elastic-search">Elastic Search</a></h2>
<p>Document Graph Explorer has integrated support for using a search engine to find documents without navigating the graph.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="graph"><a class="header" href="#graph">Graph</a></h1>
<h3 id="graph-composed-of-nodes-and-edges"><a class="header" href="#graph-composed-of-nodes-and-edges">Graph composed of Nodes and Edges</a></h3>
<p>A Document Graph is a set of documents that are connected with 0..n labeled, directional edges.</p>
<h3 id="specification"><a class="header" href="#specification">Specification</a></h3>
<ul>
<li>A document may have many edges with the same label.</li>
<li>A document may link to another document many times.</li>
<li>Edges that connect the same documents in the same direction must have unique labels.</li>
</ul>
<p><img src="specification/../mdbook-plantuml-img/c576167c29c4e23b2771fe8ce2e82305e24c4ba4.svg" alt="" /></p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="document-data-model"><a class="header" href="#document-data-model">Document Data Model</a></h2>
<p><img src="specification/doc-data-model.svg" alt="Document Data Model" /></p>
<p>Each document is comprised of the following:</p>
<ul>
<li>Header 
<ul>
<li>[required] creator (account)</li>
<li>[required] graph contract (where the document is saved)</li>
<li>[optional] created date (timepoint)</li>
<li>[optional] updated date (timepoint)</li>
<li>[optional] hash of content (not including certificates or header)</li>
</ul>
</li>
<li>Content
<ul>
<li>Value (variant) = <code>std::variant &lt;asset, string, time_point, name, int64&gt; </code></li>
<li>Content = an optionally labeled FlexValue</li>
<li>Content Group = vector<Content></li>
<li>Content Groups = vector<ContentGroup></li>
<li>Each document contains a single instance of ContentGroups.</li>
<li>This provides enough flexibility to support: 
<ul>
<li>data of all supported types,</li>
<li>short clauses of annotated text,</li>
<li>longer form sequenced data, e.g. chapters. </li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>maybe we delete certificates? a certificate could just be another document?</p>
</blockquote>
<ul>
<li>Certificates [optional]
<ul>
<li>Each document has <code>O..n</code> certificates.</li>
<li>Certificate 
<ul>
<li>certifier: the 'signer' </li>
<li>notes: string data provided by signer</li>
<li>certification_date: time_point</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Most documents have adopted a <code>system</code> group with <code>type</code> and <code>node_label</code>. Implementing these content items enables vastly improved usability within the DGE and related tools.</p>
<p><img src="specification/system-group.svg" alt="System Group" /></p>
<!-- ```plantuml
@startmindmap
* Document
** system Content Group
*** node_label
*** type (`eosio::name`)
@endmindmap
``` -->
<!-- 
```plantuml
@startmindmap
* Document
** Header
*** Owner
*** Created & Updated Dates
** Content Group 1
*** Content Item 1
**** Key (label)
**** Value
*** Content Item n
** Content Group n
@endmindmap
``` -->
<div style="break-before: page; page-break-before: always;"></div><h2 id="edge-data-model"><a class="header" href="#edge-data-model">Edge Data Model</a></h2>
<p><img src="specification/edge-data-model.svg" alt="Edge Data Model" /></p>
<pre><code>* Edge
** Creator
** From Document
** Edge Label
** To Document
** Created Date
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="eosio-implementation"><a class="header" href="#eosio-implementation">EOSIO Implementation</a></h1>
<p>For the full smart contracts, see the <a href="https://github.com/hashed-io/document-graph">Github repository</a></p>
<p>EOSIO (c++) implementation of the types of the Document Graph smart contract:</p>
<h3 id="flexvalue-type"><a class="header" href="#flexvalue-type"><code>FlexValue</code> type</a></h3>
<p>The <code>FlexValue</code> type is a variant that supports all of the common data types supported in the C++/WASM SDK for EOSIO. It stores the data as an array, where the first value is a <code>uint8</code> representing the index of the type in the <code>typedef</code> definition, followed by the actual value.</p>
<pre><code class="language-c++">    typedef std::variant&lt;std::monostate, 
                         eosio::name, 
                         std::string, 
                         eosio::asset, 
                         eosio::time_point,
                         std::int64_t, 
                         eosio::checksum256&gt;
            FlexValue;
</code></pre>
<h3 id="content-type"><a class="header" href="#content-type"><code>Content</code> type</a></h3>
<p>The <code>Content</code> type is simply a <code>FlexValue</code> with an optional label. The smart contract also creates an alias for <code>ContentGroup</code> and <code>ContentGroups</code> to organize the lists of <code>Content</code>. </p>
<p>It is common for <code>ContentGroups</code> to be labeled by using a <code>Content</code> item with a label of <code>content_group_label</code>.</p>
<pre><code class="language-c++">    struct Content {
        std::string label;
        FlexValue value;
    };

    using ContentGroup = std::vector&lt;Content&gt;;
    using ContentGroups = std::vector&lt;ContentGroup&gt;;
</code></pre>
<h4 id="example-content-group-serialized-to-json"><a class="header" href="#example-content-group-serialized-to-json">Example Content Group serialized to json</a></h4>
<pre><code class="language-json">    &quot;content_groups&quot;: [
        [
            {
                &quot;label&quot;: &quot;content_group_name&quot;,
                &quot;value&quot;: [
                    &quot;string&quot;,
                    &quot;My Salary Content Group&quot;
                ]
            },
            {
                &quot;label&quot;: &quot;salary_amount&quot;,
                &quot;value&quot;: [
                    &quot;asset&quot;,
                    &quot;130.00 USD&quot;
                ]
            },
            {
                &quot;label&quot;: &quot;recipient&quot;,
                &quot;value&quot;: [
                    &quot;name&quot;,
                    &quot;daomember&quot;
                ]
            }
        ]
    ]
</code></pre>
<h3 id="certificate-type"><a class="header" href="#certificate-type"><code>Certificate</code> type</a></h3>
<p>The <code>Certificate</code> type represents an account that is certifying, or attesting to, the content within that document. It includes the account name and optional notes for the signer. Of course, the signature from the certifier is required for creation of the certificate.</p>
<blockquote>
<p>Certificates will likely be replaced with <a href="https://www.w3.org/TR/vc-data-model/">verifiable credentials</a></p>
</blockquote>
<pre><code class="language-c++">    struct Certificate
    {
        eosio::name certifier;
        std::string notes;
        eosio::time_point certification_date = eosio::current_time_point();
    };
</code></pre>
<h3 id="document-type"><a class="header" href="#document-type"><code>Document</code> type</a></h3>
<p>The <code>Document</code> type stores the header information, <code>ContentGroups</code>, and a list of <code>Certificates</code>.</p>
<pre><code class="language-c++">    struct Document 
    {
        std::uint64_t id;
        eosio::checksum256 hash;
        eosio::name creator;
        ContentGroups content_groups;
        std::vector&lt;Certificate&gt; certificates;
        eosio::time_point created_date;
        eosio::name contract;
    };
</code></pre>
<h3 id="example-document-serialized-to-json"><a class="header" href="#example-document-serialized-to-json">Example Document serialized to json</a></h3>
<pre><code class="language-json">{
    &quot;id&quot;:4965,
    &quot;hash&quot;:&quot;50be6cf143050a11e9db3a52ef68e10e07b07cf6cc68007ad46a14baf307c5b9&quot;,
    &quot;creator&quot;: &quot;bob&quot;,
    &quot;content_groups&quot;: [
        [
            {
                &quot;label&quot;: &quot;content_group_name&quot;,
                &quot;value&quot;: [
                    &quot;string&quot;,
                    &quot;My Content Group #1&quot;
                ]
            },
            {
                &quot;label&quot;: &quot;salary_amount&quot;,
                &quot;value&quot;: [
                    &quot;asset&quot;,
                    &quot;130.00 USD&quot;
                ]
            },
            {
                &quot;label&quot;: &quot;referrer&quot;,
                &quot;value&quot;: [
                    &quot;name&quot;,
                    &quot;friendacct&quot;
                ]
            },
            {
                &quot;label&quot;: &quot;vote_count&quot;,
                &quot;value&quot;: [
                    &quot;int64&quot;,
                    67
                ]
            }
        ]
    ],
    &quot;certificates&quot;:[],
    &quot;created_date&quot;:&quot;2021-01-12T18:21:10.000&quot;,
    &quot;contract&quot;:&quot;dao.hypha&quot;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h3 id="substrate-implementation-coming-soon"><a class="header" href="#substrate-implementation-coming-soon">Substrate Implementation (coming soon)</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="getting-started"><a class="header" href="#getting-started">Getting Started</a></h1>
<blockquote>
<h2 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h2>
<p><a href="https://dge.hashed.systems/explore?document_id=0&amp;endpoint=https%3A%2F%2Fhashed.systems%2Falpha-dg-mainnet%2Fgraphql">Readme</a></p>
<ul>
<li>A Telos account</li>
<li><a href="https://greymass.com/en/anchor/">Anchor</a>  wallet installed</li>
</ul>
</blockquote>
<h2 id="features-1"><a class="header" href="#features-1">Features</a></h2>
<ul>
<li>Read document </li>
<li>Create document</li>
<li>Extend document</li>
<li>Delete document</li>
<li>Certify document</li>
<li>Navigation through URL</li>
<li>Custom GraphQL endpoints</li>
<li>Elastic Search Support</li>
<li>Save content in IPFS</li>
<li>Encrypt data</li>
</ul>
<h2 id="how-to-create-a-document"><a class="header" href="#how-to-create-a-document">How to create a document</a></h2>
<p>The Document Graph Explorer allows the creation of new documents for any user. For that, you need to click on the button New document</p>
<p><img src="explorer/./images/newDocument.png" alt="New document example" /></p>
<p>Then the only thing that you need to do is fill out the form and click on the Save button. The image below show the simplest document that you can create, only need a name and node label.</p>
<p><img src="explorer/./images/createForm.png" alt="Create form example" /></p>
<p>After the save document, the data will be updated after the finalized block and one time that the other tool catches the changes into the blockchain you will see your first document.</p>
<p><img src="explorer/./images/creatingSuccess.png" alt="Success example" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tutorials"><a class="header" href="#tutorials">Tutorials</a></h1>
<h3 id="step-by-step-walkthroughs"><a class="header" href="#step-by-step-walkthroughs">Step by step walkthroughs</a></h3>
<pre><code>- How to create a document
- How to edit a document
- How to extend the graph
- How to erase a document or edge
</code></pre>
<h3 id="advanced-topics"><a class="header" href="#advanced-topics">Advanced topics</a></h3>
<pre><code>- Using IPFS to mask content that should not be immutable
- Using the markdown editor
- Encryption
- Searching contents of linked IPFS documents
</code></pre>
<h2 id="create-your-first-document"><a class="header" href="#create-your-first-document">Create your first document</a></h2>
<p>Once you finish the steps of getting started, you should be able to create your first document, and here we are going to explain how to do it.</p>
<h3 id="before-you-start"><a class="header" href="#before-you-start">Before you start</a></h3>
<p>You can access the Document Graph Explorer on any of these endpoints</p>
<ul>
<li><a href="https://dge.hashed.systems/">Hashed System</a></li>
<li><a href="https://dge.telos.kitchen/">Telos Kitchen</a></li>
</ul>
<p>Make sure you have a TELOS account and Anchor wallet up and running!</p>
<h3 id="now-its-time"><a class="header" href="#now-its-time">Now it's time!</a></h3>
<p>When you open one of the Document Graph Explorer you'll see something like this:</p>
<p><img src="explorer/./images/tutorials/login.png" alt="Login button" /></p>
<p>What you are seeing is the general view of all documents stored at the Document Graph, feel free to play with it and navigate in all the documents and edges.</p>
<p>Anyway, once you played a bit with it it's time to write your own document!</p>
<p>To do that, you'll need to press the Sign in button in the top right corner. Once you pressed it you'll prompt to an anchor </p>
<p><img src="explorer/./images/tutorials/anchor-login.jpeg" alt="Anchor login prompt" /></p>
<p>Accept de identity authority to access all options in the Document Graph Explorer.</p>
<p>The steps to create a document are very straightforward, go ahead and press new the buttom that says <strong>New Document</strong></p>
<p><img src="explorer/./images/tutorials/create-button.png" alt="new document buttom" /></p>
<p>Once you press it, you'll get a menu that looks pretty much like this</p>
<p><img src="explorer/./images/tutorials/create-screen.png" alt="new document buttom" /></p>
<p>In that screen you can see the following information:</p>
<ul>
<li>document type</li>
<li>content groups</li>
<li>node label</li>
<li>contents</li>
</ul>
<p>Each concept can be described as follows</p>
<table><thead><tr><th>Concept</th><th>Description</th></tr></thead><tbody>
<tr><td>document type</td><td>Document types makes refers as a template of documents, it can be as Book, User. You can type your own <strong>just make sure it's not longer that 12 characters</strong></td></tr>
<tr><td>content groups</td><td>A content group is the core of the document, it can store as many contents (node labels) as you wish, and the document can store several content groups. Basically you can create and divide your document in different sections</td></tr>
<tr><td>node label</td><td>Node label is the main title of your document.</td></tr>
<tr><td>contents</td><td>Contents are pairs of data types and values stored by a key. As an example, imagine you want to store the title of a book, the key could be <strong>title</strong>, the value should be the book title (as an example: <strong>Der Steppenwolf</strong>) and the data type a <strong>String</strong>.</td></tr>
</tbody></table>
<p>Now that is settle, let's continue with our document</p>
<h3 id="letter-to-santa-claus"><a class="header" href="#letter-to-santa-claus">Letter to Santa Claus</a></h3>
<p>Lets make our first document be a letter to Santa Claus.</p>
<p>To do that, you should be at the create document screen, </p>
<ol>
<li>Write in the document type <strong>letter</strong> and press enter.</li>
<li>Press the edit button on the <strong>nodeLabel</strong> key.</li>
<li>Change <strong>Value</strong> to <strong>Letter from</strong> and your name.</li>
</ol>
<p>you should get something like this.</p>
<p><img src="explorer/./images/tutorials/letter-init.png" alt="new letter" /></p>
<p>Then press the buttom <strong>New content group</strong> and name it as <strong>body</strong></p>
<p>Once you made that, go ahead and add a new content for the new content group, write in the key <strong>salutation</strong> and in the value <strong>Dear santa,</strong>.
Make sure the data type is String and click save.</p>
<p>Now lets create a new content called <strong>main.body</strong> and in the value write your letter.</p>
<p>At the end you should have something like this:</p>
<p><img src="explorer/./images/tutorials/letter-mainbody.png" alt="main letter body" /></p>
<p>To conclude push the save buttom in the bottom left corner and sign the transaction with your wallet.</p>
<p>Congratulations! You just made your first document!</p>
<p>Also, you may not see your document as soon as you press the save button, its a small delay between the buttom press and the block validation of the blockchain, so be patient!</p>
<h2 id="edit-a-document"><a class="header" href="#edit-a-document">Edit a document</a></h2>
<p>Oh wait! It looks like we miss some information on the letter! We forgot to write the destination!</p>
<p>Let's use the search bar to find our document, just type <strong>letter from</strong> and your name to find it.
Once you found it, click it (log in if you have not done it yet) and press the <strong>edit</strong> buttom on the bottom of the page</p>
<p><img src="explorer/./images/tutorials/bottom-buttoms.png" alt="edit buttom" /></p>
<p>It only will show up if you are the creator of the document and you are logged in.</p>
<p>Now lets make a new content group called <strong>inside_address</strong></p>
<p>Then create a content called <strong>recipient</strong> and write <strong>Santa Claus</strong> in the value.</p>
<p>Create one last content called <strong>address</strong> and write <strong>North Pole</strong>.</p>
<p>You should have something like this</p>
<p><img src="explorer/./images/tutorials/letter-edited.png" alt="main letter body edited" /></p>
<p>To save it, press the save buttom and sign the transaction with your anchor wallet.</p>
<p>We did it! Now we edited our first document!</p>
<h2 id="extend-the-graph"><a class="header" href="#extend-the-graph">Extend the graph</a></h2>
<p>Now its time to extend the graph </p>
<p>Lets use the letter we made previously.</p>
<p>Search for it on the search bar and open the document, you shall see a buttom called extend.</p>
<p><img src="explorer/./images/tutorials/bottom-buttoms.png" alt="edit buttom" /></p>
<p>Go ahead and press it. Now you should see a similar page of create a new document but with a new component that says <strong>Edge Name</strong></p>
<p>What extend does is create a new document with and edge pointing to the previous document, Document Graph is based on nodes (Documents) and edges, that's why it's called Document Graph.</p>
<p>So, let's write our first edge, calling it as <strong>extras</strong>.</p>
<p>When you write an edge name, be careful of only using 12 characters or less.</p>
<p>Now edit the nodeLabel value to be <strong>Extra information</strong>.</p>
<p>Remember that nodeLabel is the title of the document.</p>
<p>After you completed the steps above, make a new content group called <strong>details</strong>, there you'll be storing the following information, use the data type String for all of them.</p>
<table><thead><tr><th>Key</th><th>Value</th></tr></thead><tbody>
<tr><td>transporter</td><td>Rudolph the Red-Nosed Reindeer Inc.</td></tr>
<tr><td>status</td><td>Shipment is out with courier for delivery</td></tr>
<tr><td>id</td><td>TzKlm258105w60280de35</td></tr>
</tbody></table>
<p>You should end with something pretty much like this:</p>
<p><img src="explorer/./images/tutorials/extend-document.png" alt="extended document" /></p>
<p>Click save and sign the transaction - Congrats! Now you have another document and it has a relation with the previous one.</p>
<h2 id="erase-a-document-or-edge"><a class="header" href="#erase-a-document-or-edge">Erase a document or edge</a></h2>
<p>To erase a document is straightforward.</p>
<p>You'll need to navigate to a document you created, then press the button erase.</p>
<p><img src="explorer/./images/tutorials/bottom-buttoms.png" alt="erase buttom" /></p>
<p>A pop up should appear.</p>
<p><img src="explorer/./images/tutorials/erase-document.png" alt="erase pop up" /></p>
<p>In the example it ask to write <strong>document Extra information</strong> in the white box below, it may vary depending on your document name. </p>
<p>Once you write the needed information you can delete the document. </p>
<p>THIS WILL PERMANENTLY DELETE THE DOCUMENT AND IT CANNOT BE UNDONE.</p>
<h1 id="advanced-topics-1"><a class="header" href="#advanced-topics-1">Advanced topics</a></h1>
<p>Congratulations! If you are reading this part is because you are an expert creating documents on Document Graph Explorer (DGE). So now lets talk about the more advance topics that DGE offers.</p>
<h2 id="using-ipfs-to-mask-content-that-should-not-be-immutable"><a class="header" href="#using-ipfs-to-mask-content-that-should-not-be-immutable">Using IPFS to mask content that should not be immutable.</a></h2>
<p>The very first one is using it to store the information in IPFS, that way the content stays the same as it is hashed with an unique CID and is immutable as long as the document points to the same CID.</p>
<p>To make that possible lets go to the old document we made (or feel free to create a new one)</p>
<p>If you want to implement this feature on your document, you need to edit or create a new content. Below it will appear a toggle buttom that says IPFS</p>
<p><img src="explorer/./images/tutorials/encrypt-1.png" alt="edit content" /></p>
<p>Once you press that buttom, click save and now it will appear as a <strong>FILE</strong>, press it to see it's content!</p>
<p>Now you know how to store content as IPFS</p>
<h2 id="using-the-markdown-editor"><a class="header" href="#using-the-markdown-editor">Using the markdown editor</a></h2>
<p>You may find a little plain to write your documents without a way to create content with custom views of it. </p>
<p>Good news! Document Graph Explorer renders contents wrote with Markdown, and its way to simple to use this feature, in your document, just create a new content and write it as you were writing any markdown document.</p>
<p>You can see a <a href="https://www.markdownguide.org/cheat-sheet">markdown cheat sheet</a> if you need some examples.</p>
<p>PS. It may not render all of the elements and LaTex is not supported.</p>
<h2 id="encryption"><a class="header" href="#encryption">Encryption</a></h2>
<p>Imagine you want to store something that's private and you don't want everybody to reads that. For that reason DGE offers a way to encrypt your data. With DGE you can encrypt your data with an advance encryption standard: AES-256 symmetric, that is virtually impenetrable using brute-force methods.</p>
<p>It sounds pretty cool, right? To do that you need to edit or create a new content. Imagine the example of extend document when we wrote the id of the card we are sending to Santa, we don't really want to show that to the world, so lets encrypt that content!</p>
<p>Navigate to your document using the search bar and log in with your account. Once it's done you can press the edit buttton on the bottom of the page. After that press the edit buttom next to the content you want to edit.</p>
<p>It should look like this:</p>
<p><img src="explorer/./images/tutorials/encrypt-1.png" alt="edit content" /></p>
<p>You can see two toggle button one for IPFS and other to encrypt your data. Press the one that says Encrypt.
Once you’ve selected the option, a Pop up will appear. </p>
<p><img src="explorer/./images/tutorials/encrypt-popup.png" alt="encrypt content" /></p>
<p>Next you need to provide a seed to encrypt and decrypt your data, see it as a key that would open or close the content. That key would not be stored in any place, so make sure you store it in a save place you'll remember, because once the content is encrypted it cannot be decrypted without that key!</p>
<p>Click Confirm. Now your content is encrypted and only you can decrypt it! You can also share the key to other people if you want them to see the content.</p>
<h2 id="searching-contents-of-linked-ipfs-documents"><a class="header" href="#searching-contents-of-linked-ipfs-documents">Searching contents of linked IPFS documents</a></h2>
<p>If you are an IPFS expert or enthusiast, you may want to store a very large file. In DGE you cant point a CID in the content to point to a file stored in IPFS. Imagine you have uploaded a book or a video and you want to include it in your document.</p>
<p>To upload it you can use of the many IPFS node distributors that exists. Or if you have already your CID you can store it as <code>ipfs://CID</code> and it automatically point to that content when you press the new FILE button that will appear once you save it.</p>
<div style="break-before: page; page-break-before: always;"></div><p><code>dgctl</code> is an open source, command line application for Document Graph organizations written in Go. It is also a secure wallet for managing private keys and submitted transactions.</p>
<h4 id="build"><a class="header" href="#build">Build</a></h4>
<p>Building <code>dgctl</code> requires Go v15 and above.</p>
<pre><code>git clone https://github.com/hashed-io/dgctl/
cd dgctl
go build
./dgctl -h
</code></pre>
<h4 id="download-binary"><a class="header" href="#download-binary">Download binary</a></h4>
<p>https://github.com/hashed-io/dgctl/releases</p>
<h4 id="run-help"><a class="header" href="#run-help">Run help</a></h4>
<pre><code>./dgctl --help                                                                                             
Usage:
  dgctl [command]

Available Commands:
  backup      creates a local backup of current graph
  create      create an object (e.g. proposal) based on the JSON file
  edit        propose an edit to a document
  get         get objects from the on-chain smart contract
  help        Help about any command
  set         set data on the on-chain smart contract
  vault       The vault is a secure key store (wallet). Your key is stored encrypted by the passphrase.

Flags:
  -a, --active               show active objects (default true)
      --config string        config file (default is ./dgctl.yaml)
      --csv                  Output data as CSV to console - not supported on all commands yet
      --debug                Enables verbose debug messages
      --expiration int       Set time before transaction expires, in seconds. Defaults to 30 seconds. (default 30)
  -f, --file string          filename
  -h, --help                 help for dgctl
      --output-file string   Output CSV data to file - not supported on all commands yet (default &quot;output.csv&quot;)
      --vault-file string    Wallet file that contains encrypted key material (default &quot;./eosc-vault.json&quot;)

Use &quot;dgctl [command] --help&quot; for more information about a command.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><p>Coming soon</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contributing"><a class="header" href="#contributing">Contributing</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
